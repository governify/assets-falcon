{   
    "name": "GALIBO INFRASTRUCTURE",
    "id": "galibo_ans",
    "version": "1.0.0",
    "type": "agreement",
    "context": {
        "validity": {
            "initial": "2021-10-07",
            "timeZone": "Europe/Madrid"
        },
        "definitions": {
            "dashboards": {},
            "group": {
                "services": [
                    "render",
                    "assets",
                    "reporter",
                    "registry",
                    "dashboard",
                    "director",
                    "naos-logs"
                ]
            },
            "schemas": {},
            "scopes": {},
            "collectors": {
                "dynamic": {
                    "infrastructurePath": "internal.collector.dynamic",
                    "endpoint": "/api/v2/computations",
                    "type": "POST-GET-V1",
                    "apiVersion": "2",
                    "config": {
                        "url": "$_[infrastructure.internal.prometheus.default]/api/v1"
                    }
                }
            }
        }
    },
    "terms": {
        "metrics": {
            "TIEMPO_RESPUESTA_MEDIO" : {
                "collector" : {
                    "$ref" : "#/context/definitions/collectors/dynamic"
                },
                "measure" : {
                    "computing" : "actual",
                    "element" : "number",
                    "params" : {
                        "steps" : {
                            "step1" : {
                                "type": "script",
                                "script": "$_[infrastructure.internal.assets.default]/api/v1/public/collector/steps/request.js",
                                "inputs" : {
                                    "request" : {
                                        "endpoint": "/query_range",
                                        "params": {
                                            "query": "sum(rate(*_http_response_time_seconds_sum[5m])) by (instance) / sum(rate(*_http_response_time_seconds_count[5m])) by (instance)",
                                            "start": ">>>period.from<<<",
                                            "end": ">>>period.to<<<",
                                            "step": "300.0"
                                        }
                                    }
                                }
                            },
                            "step2" : {}
                        }
                    }
                }
            }
        },
        "guarantees": []
    }
}